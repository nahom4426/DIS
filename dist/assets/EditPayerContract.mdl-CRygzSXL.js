import{_ as U,b7 as b,r as s,j as m,k as C,m as p,o as n,w as v,d as w,N as x,a as B,c as g,n as E,t as N,u as k,b as h,M as S,b8 as I,T as y}from"./index-BA4ml571.js";import{P as L}from"./PayerContractForm-D0YJaKNd.js";const M={class:"bg-white rounded-lg"},D={key:0,class:"p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg"},F={key:1,class:"p-4 mb-4 text-sm text-yellow-700 bg-yellow-100 rounded-lg"},j={__name:"EditPayerContract.mdl",props:{data:{type:Object,required:!0,default:()=>({})}},setup(P){const o=P,_=b(),d=s(""),c=s(!1),t=s({}),a=s("");m(()=>{console.log("EditProvider modal mounted with data prop:",o.data),o.data&&(a.value=o.data.providerUuid||"",t.value=o.data.provider||{},console.log("Extracted provider UUID:",a.value),console.log("Extracted provider data:",t.value))}),C(()=>o.data,e=>{e&&(console.log("Data prop updated:",e),a.value=e.providerUuid||"",t.value=e.provider||{})},{deep:!0});async function f(e){try{if(c.value=!0,d.value="",!a.value)throw new Error("Provider UUID is missing");const r=new FormData;e.providerLogo&&r.append("logo",e.providerLogo);const u={providerName:e.providerName,providerCode:e.providerCode,description:e.description||"",email:e.email,telephone:`${e.telephone}`,category:e.category,level:e.level||"PRIMARY",address1:e.address,state:e.state||"Ethiopia",country:e.country,latitude:e.latitude||0,longitude:e.longitude||0,tinNumber:e.tinNumber,status:e.status||"ACTIVE",providerUuid:a.value};e.providerLogo||(t.value.logoBase64?u.logoBase64=t.value.logoBase64:t.value.logoPath&&(u.logoPath=t.value.logoPath)),r.append("provider",JSON.stringify(u));const l=await I(a.value,r);if(l&&(l.success||l.status===200||l.status==="success")){const i={...t.value,...e,providerUuid:a.value};e.providerLogo||(t.value.logoBase64&&(i.logoBase64=t.value.logoBase64),t.value.logoPath&&(i.logoPath=t.value.logoPath),t.value.logoUrl&&(i.logoUrl=t.value.logoUrl)),_.update(a.value,i),y(!0,"Provider updated successfully"),o.data.onUpdated&&typeof o.data.onUpdated=="function"&&o.data.onUpdated(i),h()}}catch(r){console.error("Update error:",r),d.value=r.message||"An error occurred while updating provider",y(!1,"Failed to update provider",d.value)}finally{c.value=!1}}return(e,r)=>(n(),p(S,null,{default:v(()=>[w(x,{class:"",size:"lg",title:"Edit Provider",subtitle:"Update the provider information in the fields below."},{default:v(()=>[B("div",M,[d.value?(n(),g("div",D,N(d.value),1)):E("",!0),!a.value||Object.keys(t.value).length===0?(n(),g("div",F," Loading provider data... ")):(n(),p(L,{key:2,"initial-data":t.value,"is-edit":!0,pending:c.value,onSubmit:f,onCancel:()=>k(h)()},null,8,["initial-data","pending","onCancel"]))])]),_:1})]),_:1}))}},T=U(j,[["__scopeId","data-v-86ae96e3"]]);export{T as default};
