import{Z as U,bn as f,r as l,j as m,k as w,m as u,o as n,w as p,d as x,N as B,a as E,c as g,n as N,t as k,bp as C,u as S,b as h,M as D,bq as A,T as y,_ as I}from"./index-BA4ml571.js";const L={class:"bg-white rounded-lg"},M={key:0,class:"p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg"},F={key:1,class:"p-4 mb-4 text-sm text-yellow-700 bg-yellow-100 rounded-lg"},j=U({__name:"EditProvider.mdl",props:{data:{type:Object,required:!0,default:()=>({})}},setup(P){const a=P,_=f(),r=l(""),c=l(!1),t=l({}),o=l("");m(()=>{console.log("EditProvider modal mounted with data prop:",a.data),a.data&&(o.value=a.data.providerUuid||"",t.value=a.data.provider||{},console.log("Extracted provider UUID:",o.value),console.log("Extracted provider data:",t.value))}),w(()=>a.data,e=>{e&&(console.log("Data prop updated:",e),o.value=e.providerUuid||"",t.value=e.provider||{})},{deep:!0});async function b(e){try{if(c.value=!0,r.value="",!o.value)throw new Error("Provider UUID is missing");const d=new FormData;e.providerLogo&&d.append("logo",e.providerLogo);const v={providerName:e.providerName,threeDigitAcronym:e.threeDigitAcronym,providerCode:e.providerCode,description:e.description||"",email:e.email,telephone:`${e.telephone}`,category:e.category,level:e.level||"PRIMARY",address1:e.address1||"",address2:e.address2||"",address3:e.address3||"",state:e.state||"Ethiopia",country:e.country,latitude:e.latitude||0,longitude:e.longitude||0,tinNumber:e.tinNumber,status:e.status||"ACTIVE",providerUuid:o.value};e.providerLogo||(t.value.logoBase64?v.logoBase64=t.value.logoBase64:t.value.logoPath&&(v.logoPath=t.value.logoPath)),d.append("provider",JSON.stringify(v));const s=await A(o.value,d);if(s&&(s.success||s.status===200||s.status==="success")){const i={...t.value,...e,providerUuid:o.value};e.providerLogo||(t.value.logoBase64&&(i.logoBase64=t.value.logoBase64),t.value.logoPath&&(i.logoPath=t.value.logoPath),t.value.logoUrl&&(i.logoUrl=t.value.logoUrl)),_.update(o.value,i),y(!0,"Provider updated successfully"),a.data.onUpdated&&typeof a.data.onUpdated=="function"&&a.data.onUpdated(i),h()}}catch(d){console.error("Update error:",d),r.value=d.message||"An error occurred while updating provider",y(!1,"Failed to update provider",r.value)}finally{c.value=!1}}return(e,d)=>(n(),u(D,null,{default:p(()=>[x(B,{class:"",size:"lg",title:"Edit Provider",subtitle:"Update the provider information in the fields below."},{default:p(()=>[E("div",L,[r.value?(n(),g("div",M,k(r.value),1)):N("",!0),!o.value||Object.keys(t.value).length===0?(n(),g("div",F," Loading provider data... ")):(n(),u(C,{key:2,"initial-data":t.value,"is-edit":!0,pending:c.value,onSubmit:b,onCancel:()=>S(h)()},null,8,["initial-data","pending","onCancel"]))])]),_:1})]),_:1}))}}),R=I(j,[["__scopeId","data-v-dcb8f85e"]]);export{R as default};
