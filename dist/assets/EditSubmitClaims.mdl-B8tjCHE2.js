import{_ as g,az as _,r,j as U,k as N,m as c,o as u,w as h,d as w,N as P,a as I,c as m,n as B,t as S,u as k,b as v,M as x,aA as E,T as b}from"./index-BA4ml571.js";import{I as C}from"./submitClaimsForm-orHStDkl.js";const D={class:"bg-white rounded-lg"},F={key:0,class:"p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg"},M={key:1,class:"p-4 mb-4 text-sm text-yellow-700 bg-yellow-100 rounded-lg"},A={__name:"EditSubmitClaims.mdl",props:{data:{type:Object,required:!0,default:()=>({})}},setup(f){const s=f;_();const o=r(""),l=r(!1),t=r({}),a=r("");U(()=>{s.data&&(a.value=s.data.insuredUuid||"",t.value=s.data.insured||{})}),N(()=>s.data,e=>{e&&(a.value=e.insuredUuid||"",t.value=e.insured||{})},{deep:!0});async function y(e){try{if(l.value=!0,o.value="",!a.value)throw new Error("Insured UUID is missing");const d=new FormData;e.employeePhoto&&d.append("photo",e.employeePhoto);const p={firstName:e.firstName,payerUuid:e.payerUuid,fatherName:e.fatherName,grandFatherName:e.grandFatherName||e.grandfatherName,birthDate:e.birthDate?`${e.birthDate}T00:00:00.000Z`:"",phone:`${e.phone}`,address:e.address||"",state:e.state||"Addis Ababa",country:e.country||"Ethiopia",idNumber:e.idNumber,position:e.position,gender:e.gender,status:e.status||"ACTIVE",email:e.email||"",insuredUuid:a.value};e.employeePhoto||(t.value.photoBase64?p.photoBase64=t.value.photoBase64:t.value.photoPath&&(p.photoPath=t.value.photoPath)),d.append("insured",JSON.stringify(p));const i=await E(a.value,d);if(i&&(i.success||i.status===200||i.status==="success")){const n={...t.value,...e,insuredUuid:a.value};e.employeePhoto||(t.value.photoBase64&&(n.photoBase64=t.value.photoBase64),t.value.photoPath&&(n.photoPath=t.value.photoPath),t.value.photoUrl&&(n.photoUrl=t.value.photoUrl)),insuredStore.update(a.value,n),b(!0,"Insured member updated successfully"),s.data.onUpdated&&typeof s.data.onUpdated=="function"&&s.data.onUpdated(n),v()}else throw new Error((i==null?void 0:i.error)||"Update failed")}catch(d){console.error("Update error:",d),o.value=d.message||"An error occurred while updating insured member",b(!1,"Failed to update insured member",o.value)}finally{l.value=!1}}return(e,d)=>(u(),c(x,null,{default:h(()=>[w(P,{class:"",size:"lg",title:"Edit Insured Member",subtitle:"Update the insured member information in the fields below."},{default:h(()=>[I("div",D,[o.value?(u(),m("div",F,S(o.value),1)):B("",!0),!a.value||Object.keys(t.value).length===0?(u(),m("div",M," Loading insured member data... ")):(u(),c(C,{key:2,"initial-data":t.value,"is-edit":!0,institutionId:t.value.payerUuid,pending:l.value,onSubmit:y,onCancel:()=>k(v)()},null,8,["initial-data","institutionId","pending","onCancel"]))])]),_:1})]),_:1}))}},z=g(A,[["__scopeId","data-v-20ffffda"]]);export{z as default};
