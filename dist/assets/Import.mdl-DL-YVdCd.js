import{h as U,aa as V,r as u,c as p,o as n,d as b,w as d,a as s,n as m,D as z,t as h,aF as P,m as E,B as _,s as w,u as k,b as f,e as S,N as M,bu as j,T as C,bv as A}from"./index-BA4ml571.js";const $={class:"bg-black/50 min-h-full p-6 grid place-items-center"},R={class:"p-4 w-full max-w-md"},G={class:"mb-4"},H=["disabled"],J={key:1,class:"mb-4"},K={class:"flex justify-between text-sm text-gray-600 mb-1"},L={class:"w-full bg-gray-200 rounded-full h-2.5"},O={class:"flex gap-3 justify-end items-center w-full p-4 border-t"},X={__name:"Import.mdl",props:{data:String},setup(I){var x,y;const v=I,l=U(),g=(y=(x=V().auth)==null?void 0:x.user)==null?void 0:y.providerUuid,i=u(0),o=u(!1),c=u(),t=u({type:null,text:null}),F=()=>{i.value=0,o.value=!1,t.value={type:null,text:null},c.value.value=""},B=a=>{if(!a)return t.value={type:"error",text:"Please select a file"};F(),o.value=!0,v.data=="drug"?l.send(()=>j({providerUuid:g},a,{onUploadProgress:e=>i.value=e.total?Math.round(e.loaded*100/e.total):0}),e=>{var r;l!=null&&l.success?(t.value={type:"success",text:"Import completed!"},C.success("Drug imported"),setTimeout(f,2e3)):t.value={type:"error",text:((r=l.response.value)==null?void 0:r.message)||"Import failed"}}):l.send(()=>A({providerUuid:g},a,{onUploadProgress:e=>i.value=e.total?Math.round(e.loaded*100/e.total):0}),e=>{var r;l!=null&&l.success?(t.value={type:"success",text:"Import completed!"},C.success("Services imported"),setTimeout(f,2e3)):t.value={type:"error",text:((r=l.response.value)==null?void 0:r.message)||"Import failed"}})},D=a=>{const e=a.target.files[0],r=new FormData;if(r.append("file",e),!e)return;if(!["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type))return t.value={type:"error",text:"Please upload Excel/CSV file"},a.target.value="";B(r)},N=()=>{var a;(a=c.value)==null||a.click()},T=v.data==="drug"?"Import Drug":"Import Service";return(a,e)=>(n(),p("div",$,[b(M,{size:"xs",class:"flex justify-center bg-white",title:k(T)},{bottom:d(()=>[s("div",O,[b(_,{onClick:w(k(f),["prevent"]),class:"flex items-center border border-gray-300 text-gray-700 font-medium hover:bg-gray-50",size:"md",disabled:o.value},{default:d(()=>e[3]||(e[3]=[S(" Cancel ")])),_:1,__:[3]},8,["onClick","disabled"]),!o.value&&t.value.type!=="success"?(n(),E(_,{key:0,onClick:w(N,["prevent"]),class:"flex items-center bg-primary text-white font-medium hover:bg-primary/80",size:"md"},{default:d(()=>e[4]||(e[4]=[S(" Select File ")])),_:1,__:[4]})):m("",!0)])]),default:d(()=>[s("div",R,[s("div",G,[e[0]||(e[0]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Select File (Excel/CSV)",-1)),s("input",{ref_key:"fileInput",ref:c,type:"file",accept:".csv, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:o.value,onChange:D},null,40,H)]),t.value.text?(n(),p("div",{key:0,class:z(`mb-4 p-3 rounded-md ${t.value.type==="error"?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`)},h(t.value.text),3)):m("",!0),o.value?(n(),p("div",J,[s("div",K,[e[1]||(e[1]=s("span",null,"Uploading...",-1)),s("span",null,h(i.value)+"%",1)]),s("div",L,[s("div",{class:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:P(`width: ${i.value}%`)},null,4)])])):m("",!0),e[2]||(e[2]=s("div",{class:"text-xs text-gray-500 mt-2"}," Ensure your file follows the required format. ",-1))])]),_:1},8,["title"])]))}};export{X as default};
