import{Z as w,aB as b,r as g,a3 as N,m as v,o as P,w as s,d as l,N as C,a as A,aC as D,aD as F,u as S,b as y,M as $}from"./index-BA4ml571.js";const q={class:"bg-white rounded-lg"},M=w({__name:"AddPayer.mdl",setup(B){const h=b(),o=g(!1),_=N(),t=g();function f(e){return e.replace(/^(\+\d{3})0/,"$1")}async function m(e){var r,d;try{o.value=!0;const c=["payerName","category","telephone"].filter(n=>!e[n]);if(c.length>0)throw new Error(`Missing required fields: ${c.join(", ")}`);const i=new FormData;e.payerLogo&&i.append("logo",e.payerLogo);const u={payerName:e.payerName,dependantCoverage:e.dependantCoverage,description:e.description||e.memo,telephone:f(e.telephone),category:e.category,email:e.email||e.payerName+"@gmail.com",address1:e.address1||"",address2:e.address2||"",address3:e.address3||"",state:e.state||"Addis Ababa",country:e.country||"Ethiopia",latitude:e.latitude||0,longitude:e.longitude||0,tinNumber:e.tinNumber||"",status:e.status||"ACTIVE"};i.append("payerRequest",JSON.stringify(u)),console.log("Submitting payer data:",u);const a=await t.value.register(i);if(a.success){const n={...a.data,logoUrl:a.data.logoUrl||(a.data.logoPath?`http://localhost:8080/api/payer/logo/${a.data.logoPath}`:null)};h.add(n),(d=(r=t.value.props)==null?void 0:r.data)!=null&&d.onAdded&&typeof t.value.props.data.onAdded=="function"&&t.value.props.data.onAdded(n),y(),_.push("/payer_list")}else throw new Error(a.error||"Registration failed")}catch(p){console.error("Submission error:",p)}finally{o.value=!1}}return(e,r)=>(P(),v($,null,{default:s(()=>[l(C,{class:"",size:"lg",title:"New Payer",subtitle:"To add a new payer, please fill out the information in the fields below."},{default:s(()=>[A("div",q,[l(D,{ref_key:"formDataProvider",ref:t},{default:s(({pending:d})=>[l(F,{pending:o.value,onSubmit:m,onCancel:()=>S(y)()},null,8,["pending","onCancel"])]),_:1},512)])]),_:1})]),_:1}))}});export{M as default};
