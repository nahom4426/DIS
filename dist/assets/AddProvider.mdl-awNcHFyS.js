import{r as c,a3 as _,bn as b,m as f,o as m,w as s,d as n,N as w,a as y,bo as N,bp as P,u as A,b as u,M as D,T as F}from"./index-BA4ml571.js";const C={class:"bg-white rounded-lg"},M={__name:"AddProvider.mdl",setup(S){const i=c(!1),v=_(),t=c(),g=b();async function h(e){try{i.value=!0;const l=["providerName","threeDigitAcronym","tinNumber","category"].filter(a=>!e[a]);if(l.length>0)throw new Error(`Missing required fields: ${l.join(", ")}`);const d=new FormData;e.providerLogo&&d.append("logo",e.providerLogo);const p={providerName:e.providerName,threeDigitAcronym:e.threeDigitAcronym,providerCode:e.providerCode,description:e.description||"",email:e.email,telephone:`${e.telephone}`,category:e.category,level:e.level||"PRIMARY",address1:e.address1||"",address2:e.address2||"",address3:e.address3||"",state:e.state||"Ethiopia",country:e.country||"Ethiopia",latitude:e.latitude||0,longitude:e.longitude||0,tinNumber:e.tinNumber,status:e.status||"ACTIVE"};d.append("provider",JSON.stringify(p)),console.log("Submitting provider data:",p);const r=await t.value.register(d);if(r.success){const a={...r.data,logoUrl:r.data.logoUrl||(r.data.logoPath?`http://localhost:8080/api/provider/logo/${r.data.logoPath}`:null)};g.add(a),t.value.props&&t.value.props.data&&t.value.props.data.onAdded&&typeof t.value.props.data.onAdded=="function"&&t.value.props.data.onAdded(a),u(),v.push("/provider_list")}else throw new Error(r.error||"Registration failed")}catch(o){console.error("Submission error:",o),F(!1,"Failed to submit form",o.message)}finally{i.value=!1}}return(e,o)=>(m(),f(D,null,{default:s(()=>[n(w,{class:"",size:"lg",title:"New Provider",subtitle:"To add a new provider, please fill out the information in the fields below."},{default:s(()=>[y("div",C,[n(N,{ref_key:"formDataProvider",ref:t},{default:s(()=>[n(P,{pending:i.value,onSubmit:h,onCancel:()=>A(u)()},null,8,["pending","onCancel"])]),_:1},512)])]),_:1})]),_:1}))}};export{M as default};
