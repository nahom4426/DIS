import{_ as x,r as o,f as N,g as B,h as F,j as S,k as C,l as j,m,o as n,w as y,d as M,N as A,a as I,c as h,n as O,t as P,U as q,u as U,b as _,M as L,p as T}from"./index-BA4ml571.js";const z={class:"bg-white rounded-lg"},D={key:0,class:"p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg"},R={key:1,class:"p-4 mb-4 text-sm text-yellow-700 bg-yellow-100 rounded-lg"},G={__name:"EditUser.mdl",props:{data:{type:Object,default:()=>({})}},setup(b){var v,p;const a=b,r=o(((v=a.data)==null?void 0:v.userUuid)||""),t=o(((p=a.data)==null?void 0:p.user)||{}),l=o(!1),s=o(""),w=N(),{addToast:u}=B(),c=F();S(async()=>{console.log("EditUser modal received data:",a.data),a.data&&a.data.userUuid&&(r.value=a.data.userUuid,t.value=a.data.user||{},r.value&&(!t.value||Object.keys(t.value).length===0)&&await k())}),C(()=>a.data,e=>{e&&(r.value=e.userUuid||"",t.value=e.user||{})},{deep:!0});async function k(){try{l.value=!0,c.send(()=>j(r.value),e=>{e.success?(t.value=e.data,console.log("Fetched user data:",t.value)):(s.value=e.error||"Failed to fetch user data",u({type:"error",title:"Error",message:s.value})),l.value=!1})}catch(e){s.value=e.message||"An error occurred while fetching user data",u({type:"error",title:"Error",message:s.value}),l.value=!1}}async function E(e){var i;try{l.value=!0,console.log("Form submitted with values:",e);const d={...e,gender:(i=e.gender)==null?void 0:i.toLowerCase()};console.log("Sending user payload:",d),c.send(()=>T(r.value,d),g=>{if(g.success){const f={...t.value,...e,userUuid:r.value,roleName:t.value.roleName};w.update(r.value,f),u({type:"success",title:"Success",message:"User updated successfully"}),a.data.onUpdated&&typeof a.data.onUpdated=="function"&&a.data.onUpdated(f),_()}else s.value=g.error||"Failed to update user",u({type:"error",title:"Error",message:s.value});l.value=!1})}catch(d){s.value=d.message||"An error occurred while updating user",u({type:"error",title:"Error",message:s.value}),l.value=!1}}return(e,i)=>(n(),m(L,null,{default:y(()=>[M(A,{class:"",size:"lg",title:"Edit User",subtitle:"Update the user information in the fields below."},{default:y(()=>[I("div",z,[s.value?(n(),h("div",D,P(s.value),1)):O("",!0),!r.value||Object.keys(t.value).length===0?(n(),h("div",R," Loading user data... ")):(n(),m(q,{key:2,"initial-data":t.value,"is-edit":!0,pending:l.value||U(c).pending.value,onSubmit:E,onCancel:()=>U(_)()},null,8,["initial-data","pending","onCancel"]))])]),_:1})]),_:1}))}},J=x(G,[["__scopeId","data-v-b529e115"]]);export{J as default};
