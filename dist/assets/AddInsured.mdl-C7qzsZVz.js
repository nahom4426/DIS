import{r as l,a3 as f,aH as y,m as g,o as _,w as n,d,N,a as w,aI as v,u as A,b as c,M as F}from"./index-BA4ml571.js";import{I as P}from"./InsuredMemberForm-BPyVVZqT.js";const D={class:"bg-white rounded-lg"},S={__name:"AddInsured.mdl",setup(U){const s=l(!1),h=f(),t=l(),m=y();async function b(e){try{s.value=!0;const p=["payerUuid","firstName","fatherName","idNumber","phone"].filter(o=>!e[o]);if(p.length>0)throw new Error(`Missing required fields: ${p.join(", ")}`);const i=new FormData;e.employeePhoto&&i.append("photo",e.employeePhoto);const u={email:e.email||"",firstName:e.firstName,payerUuid:e.payerUuid,fatherName:e.fatherName,grandFatherName:e.grandFatherName,groupUuid:e.groupUuid,birthDate:e.birthDate,phone:e.phone,woreda:e.woreda||"",state:e.state||"Addis Ababa",city:e.city||"",subcity:e.subcity||"",country:e.country||"Ethiopia",idNumber:e.idNumber,position:e.position,gender:e.gender,status:e.status||"ACTIVE"};i.append("insured",JSON.stringify(u)),console.log("Submitting insured data:",u);const a=await t.value.register(i);if(a.success){const o={...a.data,photoUrl:a.data.photoUrl||(a.data.photoPath?`http://localhost:8080/api/insured/photo/${a.data.photoPath}`:null)};m.add(o),t.value.props&&t.value.props.data&&t.value.props.data.onAdded&&typeof t.value.props.data.onAdded=="function"&&t.value.props.data.onAdded(o),c(),h.push("/insured_list")}}catch(r){console.error("Submission error:",r)}finally{s.value=!1}}return(e,r)=>(_(),g(F,null,{default:n(()=>[d(N,{class:"",size:"lg",title:"Add Employee",subtitle:"To add a new employee, please fill out the information in the fields below."},{default:n(()=>[w("div",D,[d(v,{ref_key:"formDataProvider",ref:t},{default:n(()=>[d(P,{onSubmit:b,onCancel:()=>A(c)()},null,8,["onCancel"])]),_:1},512)])]),_:1})]),_:1}))}};export{S as default};
